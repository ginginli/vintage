# 股票分析助手

基于《笑傲牛熊》的股票分析工具，帮助投资者进行技术分析和决策。

## 项目结构
tock-analyzer/
├── api/
│ ├── health.js # 健康检查接口
│ └── stock.js # 股票数据获取接口
├── public/
│ ├── js/
│ │ ├── analyzers/ # 分析器模块
│ │ │ ├── TrendAnalyzer.js # 趋势分析
│ │ │ ├── VolumePriceAnalyzer.js # 量价分析
│ │ │ └── InstitutionalAnalyzer.js # 主力行为分析
│ │ ├── vintage.js # 主程序
│ │ └── echarts.min.js # 图表库
│ └── index.html # 前端页面
├── vercel.json # 部署配置


## 核心功能模块

### 1. 数据获取 (StockAPI)
- 调用 Alpha Vantage API 获取股票数据
- 实现请求限流（15秒间隔）
- 包含重试机制（最多3次）
- 错误处理和响应

### 2. 图表展示 (ChartManager)
- K线图展示
- MA5/10/20/60均线
- 成交量
- 支持时间范围切换（250/180/120/60天）

### 3. 趋势分析 (TrendAnalyzer)
- MA20核心指标分析
  - 价格与MA20位置关系判断
  - MA20形态分析（上升、下降、横盘）
  - 趋势转折点识别
- 趋势级别判断
  - 大级别趋势（涨跌幅>20%）
  - 中级别趋势（涨跌幅>10%）
  - 小级别趋势（涨跌幅<10%）

### 4. 量价分析 (VolumePriceAnalyzer)
- 成交量变化分析
  - 近5日均量与前5日均量对比
  - 变化幅度计算
- 价格涨跌幅分析
  - 20天价格变化
  - 量价配合关系判断
- 市场阶段判断
  - 建仓阶段：缩量调整，温和放量上涨
  - 上升阶段：量价齐升，买盘积极
  - 派发阶段：高位放量，上涨乏力
  - 下跌阶段：放量下跌，卖压沉重

### 5. 主力行为分析 (InstitutionalAnalyzer)
- 主力资金特征分析
  - 主力资金活跃度判断
  - 主力建仓特征识别
  - 主力出货特征识别
- 主力行为阶段判断
  - 主力拉升
  - 主力派发
  - 主力撤离
  - 主力观望

### 6. 市场特征判断
- 多头市场特征
  - MA20向上倾斜
  - 价格站稳MA20上方
  - 成交量配合
- 空头市场特征
  - MA20向下倾斜
  - 价格跌破MA20
  - 放量下跌
- 盘整市场特征
  - MA20横盘
  - 价格在MA20附近波动
  - 成交量平稳

### 7. 操作建议生成
- 未持有策略
  - 多头市场：回调买入策略
  - 空头市场：观望策略
  - 盘整市场：试探性策略
- 持有策略
  - 多头市场：持股策略
  - 空头市场：减仓策略
  - 盘整市场：轻仓策略
- 仓位控制建议
  - 多头市场：80-90%
  - 空头市场：0-30%
  - 盘整市场：30-50%

## 技术指标说明

### MA20核心指标
- 计算方法：MA20 = (C1 + C2 + ... + C20) / 20
- 位置判断：
  - 站稳：连续3天上站MA20，偏离度≤8%
  - 跌破：连续3天下破MA20，偏离度>3%
  - 徘徊：价格在MA20上下3%范围内波动

### 量价配合
- 成交量变化：(近5日均量 - 前5日均量) / 前5日均量
- 价格变化：(当前价格 - 20天前价格) / 20天前价格
- 判断标准：
  - 放量上涨：量增>30%，涨幅>8%
  - 放量下跌：量增>30%，跌幅>8%
  - 缩量上涨：量减>30%，涨幅>8%
  - 缩量下跌：量减>30%，跌幅>8%

## 使用限制
- 每次查询后需等待15秒
- 每分钟最多5次请求
- 每天最多500次请求

## 部署说明
项目使用 Vercel 部署，需要设置以下环境变量：
- ALPHA_VANTAGE_API_KEY：Alpha Vantage API密钥
- ALPHA_VANTAGE_BASE_URL：API基础URL

## 更新日志

### 2024.03
- 新增趋势转折点分析
- 新增市场阶段判断
- 新增主力资金分析
- 优化分析结果展示